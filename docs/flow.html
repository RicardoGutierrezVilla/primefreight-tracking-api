<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PrimeFreight API – Flow</title>
    <style>
      body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
      header { padding:16px 24px; background:#0b1f2a; color:#e6f1f6; }
      h1 { margin:0 0 8px 0; font-size:20px; }
      main { padding:16px 24px; }
      svg { max-width: 1200px; width: 100%; height: auto; }
    </style>
  </head>
  <body>
    <header>
      <h1>PrimeFreight Tracking API – Client Flow</h1>
      <p style="margin:0; opacity:0.9;">How to authenticate and call endpoints</p>
    </header>
    <main>
      <svg viewBox="0 0 1200 520" role="img" aria-label="PrimeFreight API client flow diagram">
        <defs>
          <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
            <path d="M 0 0 L 10 5 L 0 10 z" fill="#4a5568"></path>
          </marker>
          <style>
            .box { fill: #f8fafc; stroke: #cbd5e1; stroke-width: 1.5; rx: 6; }
            .title { font: 600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #0b1f2a; }
            .small { font: 12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #334155; }
            .arrow { stroke: #4a5568; stroke-width: 2; fill: none; marker-end: url(#arrow); }
          </style>
        </defs>

        <!-- Client -->
        <rect class="box" x="20" y="40" width="220" height="70" />
        <text class="title" x="130" y="70" text-anchor="middle">Client App</text>
        <text class="small" x="130" y="90" text-anchor="middle">Frontend or Server</text>

        <!-- Step 1: Login -->
        <rect class="box" x="290" y="20" width="280" height="110" />
        <text class="title" x="430" y="50" text-anchor="middle">1) Login</text>
        <text class="small" x="430" y="72" text-anchor="middle">POST /auth/tokens</text>
        <text class="small" x="430" y="92" text-anchor="middle">Body: { username, password }</text>
        <text class="small" x="430" y="108" text-anchor="middle">Response: Bearer token (2h)</text>

        <!-- Step 2: Create tracking request (get tracking id) -->
        <rect class="box" x="260" y="160" width="300" height="110" />
        <text class="title" x="410" y="190" text-anchor="middle">2) Create Tracking Request</text>
        <text class="small" x="410" y="212" text-anchor="middle">POST /tracking-requests</text>
        <text class="small" x="410" y="232" text-anchor="middle">Header: Authorization: Bearer &lt;token&gt;</text>
        <text class="small" x="410" y="252" text-anchor="middle">Returns: tracking_request.id</text>

        <!-- Step 3: Use tracking id to fetch container id -->
        <rect class="box" x="600" y="160" width="300" height="110" />
        <text class="title" x="750" y="190" text-anchor="middle">3) Get Tracking Request</text>
        <text class="small" x="750" y="212" text-anchor="middle">GET /tracking-requests/{id}</text>
        <text class="small" x="750" y="232" text-anchor="middle">Yields: container_id</text>

        <!-- Step 4/5: Get container and events by container id -->
        <rect class="box" x="430" y="300" width="300" height="120" />
        <text class="title" x="580" y="330" text-anchor="middle">4) Get Container</text>
        <text class="small" x="580" y="350" text-anchor="middle">GET /containers/{containerId}</text>
        <text class="title" x="580" y="372" text-anchor="middle">5) Get Events</text>
        <text class="small" x="580" y="392" text-anchor="middle">GET .../raw-events • /transport-events</text>

        <!-- Step 6: Receive live notifications via webhook -->
        <rect class="box" x="780" y="300" width="330" height="120" />
        <text class="title" x="945" y="330" text-anchor="middle">6) Receive Webhooks </text>
        <text class="small" x="945" y="350" text-anchor="middle">We POST updates to your webhook URL</text>
        <text class="small" x="945" y="370" text-anchor="middle">Example: container.updated, event.created</text>
        <text class="small" x="945" y="390" text-anchor="middle">Respond 2xx to acknowledge</text>

        <!-- Arrows -->
        <path class="arrow" d="M 240 75 L 260 75" />
        <path class="arrow" d="M 410 130 L 410 160" />
        <path class="arrow" d="M 560 215 L 600 215" />
        <path class="arrow" d="M 750 270 L 580 300" />
        <path class="arrow" d="M 580 360 L 780 360" />

        <!-- Notes -->
      </svg>

      <h2 style="margin:20px 0 8px; font-size:16px; color:#0b1f2a;">Endpoints</h2>
      <ul style="margin:0 0 8px 18px; line-height:1.8; color:#0b1f2a;">
        <li><code>POST /auth/tokens</code> — obtain Bearer token (2h)</li>
        <li><code>POST /tracking-requests</code> — create tracking request</li>
        <li><code>GET /tracking-requests/{id}</code> — get tracking request</li>
        <li><code>GET /containers/{containerId}</code> — get container</li>
        <li><code>GET /containers/{containerId}/raw-events</code> — get raw events</li>
        <li><code>GET /containers/{containerId}/transport-events</code> — get transport events</li>
      </ul>

      <p style="color:#334155; font-size:13px; margin-top:8px;">Tip: Include <code>Authorization: Bearer &lt;token&gt;</code> on all calls except <code>/auth/tokens</code>. Typical sequence: create tracking request → use tracking id to get container id → use container id to get container and events. Optionally, configure a webhook URL to receive live notifications (we POST JSON to your endpoint).</p>
    </main>
  </body>
</html>
